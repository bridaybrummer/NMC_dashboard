---
title: "Methods"
subtitle: "Data sources, calculations, quality control & analytical approaches"
format:
  html:
    toc: true
    toc-depth: 3
---

## Data Sources {#data-sources}

| Source | Description | Update Frequency |
|--------|-------------|-----------------|
| **NMC** (Notifiable Medical Conditions) | Case-based surveillance of notifiable conditions | Weekly |
| **Stats SA** | Mid-year population estimates, life tables, vital registrations | Annual |
| **MYPE** | Mid-Year Population Estimates for incidence rate denominators | Annual |
| **WHO** | Standard population for age-standardised rates; disability weights (GBD 2019) | Reference dataset |

---

## Data Pipeline {#pipeline}

The dashboard data flows through the following pipeline:

1. **Import** — `R/data_import.r` reads raw NMC data and reference files
2. **Cleaning & QC** — deduplication, date validation, district dictionary lookups
3. **Aggregation** — `R/aggregator_national.r` produces national, provincial and district summaries
4. **Dashboard preparation** — `R/prepare_dashboard_data.r` writes `.rds` files to `data/processed/`
5. **Forecasting** — `R/run_forecasts.r` + `R/epinow2_functions.r` produce short-term forecasts
6. **Rendering** — Quarto renders `.qmd` pages into the `_site/` output directory

---

## Indicator Definitions {#indicators}

### Incidence Rate
$$
\text{Incidence} = \frac{\text{Cases}}{\text{Population}} \times 100\,000
$$

Population denominators are from Stats SA mid-year estimates.

### Years of Life Lost (YLL)
$$
\text{YLL} = \sum_{i} d_i \times e_i
$$

Where $d_i$ is the number of deaths at age $i$ and $e_i$ is the remaining life expectancy at age $i$ from the SA life table.

### DALYs
$$
\text{DALY} = \text{YLL} + \text{YLD}
$$

Where $\text{YLD} = \text{prevalent cases} \times \text{disability weight} \times \text{duration}$.

### Age-Standardised Rate (ASR)
$$
\text{ASR} = \frac{\sum_{i} w_i \cdot r_i}{\sum_{i} w_i} \times 100\,000
$$

Where $w_i$ is the WHO standard population weight for age group $i$ and $r_i$ is the age-specific rate.

---

## Signal Detection {#signal-detection}

The [Trending](by-trending/index.html) section uses:

- **CUSUM** (Cumulative Sum) — detects sustained shifts from the expected mean
- **EARS C1/C2/C3** — CDC's Early Aberration Reporting System algorithms for rapid signal detection

Thresholds and baseline windows are documented in the trending page notes.

---

## Forecasting {#forecasting}

Short-term forecasts in the [Forecasts](by-forecasts/index.html) section use **EpiNow2**:

- Renewal equation–based model with Rt estimation
- Generation interval and incubation period distributions sourced from literature
- Forecast horizon: 1–6 weeks with 50% and 95% credible intervals
- Nowcasting: delay-adjusted counts using empirical reporting delay distributions

---

## Quality Control {#qc}

See the [Data Quality](quality.html) page for detailed metrics. Key checks include:

- **Completeness** — proportion of expected reports received by district and week
- **Timeliness** — median reporting delay (notification → NMC entry)
- **Duplicates** — fuzzy matching on name, date of birth, condition and date of onset
- **Consistency** — cross-checks between age, date of onset, and notification date

---

## Software & Reproducibility {#software}

| Tool | Version | Purpose |
|------|---------|---------|
| R | ≥ 4.3 | Data processing and analysis |
| Quarto | ≥ 1.4 | Dashboard rendering |
| EpiNow2 | ≥ 1.4 | Forecasting & Rt estimation |
| Plotly / Leaflet | Latest | Interactive visualisations |
| DT | Latest | Interactive data tables |

All code is open-source. See the [About](about.html) page for repository links and contribution guidelines.

---

::: {.callout-tip}
## Quick Navigation
- [Glossary](glossary.html) — abbreviations and term definitions
- [About](about.html) — credits, partners and contact information
- [Home](index.html) — return to the main dashboard
:::
